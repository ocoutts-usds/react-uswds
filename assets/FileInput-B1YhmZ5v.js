import{j as i}from"./jsx-runtime-CKrituN3.js";import{r as t}from"./index-CBqU2yxZ.js";import{c as N}from"./index-Bl6ORisp.js";const P="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",C=({imageId:p,file:g})=>{const a=t.useRef(new FileReader),[r,S]=t.useState(!0),[m,h]=t.useState(P),[d,v]=t.useState(!1);t.useEffect(()=>(a.current.onloadend=()=>{S(!1),h(a.current.result)},a.current.readAsDataURL(g),()=>{a.current.onloadend=null}),[]);const{name:s}=g,A=()=>{h(P),v(!0)},w=s.indexOf(".pdf")>0,I=s.indexOf(".doc")>0||s.indexOf(".pages")>0,_=s.indexOf(".mov")>0||s.indexOf(".mp4")>0,F=s.indexOf(".xls")>0||s.indexOf(".numbers")>0,y=N("usa-file-input__preview-image",{"is-loading":r,"usa-file-input__preview-image--pdf":d&&w,"usa-file-input__preview-image--word":d&&I,"usa-file-input__preview-image--video":d&&_,"usa-file-input__preview-image--excel":d&&F,"usa-file-input__preview-image--generic":d&&(!w&&!I&&!_&&!F)});return i.jsxs("div",{"data-testid":"file-input-preview",className:"usa-file-input__preview","aria-hidden":"true",children:[i.jsx("img",{id:p,"data-testid":"file-input-preview-image",src:m,alt:"",className:y,onError:A}),s]})};C.__docgenInfo={description:"",methods:[],displayName:"FilePreview",props:{imageId:{required:!0,tsType:{name:"string"},description:""},file:{required:!0,tsType:{name:"File"},description:""}}};const M=p=>p.replace(/[^a-z0-9]/g,function(a){const r=a.charCodeAt(0);return r===32?"-":r>=65&&r<=90?`img_${a.toLowerCase()}`:`__${r.toString(16).slice(-4)}`}),b=({name:p,id:g,dragText:a,chooseText:r,errorText:S,disabled:m,multiple:h,className:d,accept:v,onChange:s,onDrop:A,...w},I)=>{const _=t.useRef(null),[F,D]=t.useState(!1),[y,E]=t.useState(!1),[l,R]=t.useState([]),[L,$]=t.useState(!1);t.useEffect(()=>{if(typeof navigator>"u")return;const e=/rv:11.0/i.test(navigator==null?void 0:navigator.userAgent)||/Edge\/\d./i.test(navigator==null?void 0:navigator.userAgent);$(e)},[typeof navigator]),t.useImperativeHandle(I,()=>({input:_.current,clearFiles:()=>R([]),files:l}),[l]);const k=N("usa-file-input",{"usa-file-input--disabled":m},d),G=N("usa-file-input__target",{"usa-file-input--drag":F,"has-invalid-file":y}),B=h?"Drag files here or ":"Drag file here or ",H="choose from folder",q="This is not a valid file type.",f=[];if(l)for(let e=0;e<(l==null?void 0:l.length);e++){const o=M(l[parseInt(`${e}`)].name),n=`filePreview_${o}`;f.push(i.jsx(C,{imageId:o,file:l[parseInt(`${e}`)]},n))}const z=N("usa-file-input__instructions",{"display-none":f.length>0}),Q=f.length>1?`${f.length} files selected`:"Selected file",U=e=>{if(E(!1),v){const o=v.split(",");let n=!0;for(let c=0;c<e.dataTransfer.files.length;c+=1){const x=e.dataTransfer.files[parseInt(`${c}`)];if(n)for(let u=0;u<o.length;u+=1){const j=o[parseInt(`${u}`)];if(n=x.name.indexOf(j)>0||x.type.includes(j.replace(/\*/g,"")),n)break}else break}n||(R([]),E(!0),e.preventDefault(),e.stopPropagation())}},V=()=>D(!0),W=()=>D(!1),J=e=>{U(e),D(!1),A&&A(e)},K=e=>{var n,c,x,u;E(!1);const o=[];if((c=(n=e.target)==null?void 0:n.files)!=null&&c.length){const j=((u=(x=e.target)==null?void 0:x.files)==null?void 0:u.length)||0;for(let T=0;T<j;T++){const O=e.target.files.item(T);O&&o.push(O)}}R(o),s&&s(e)};return i.jsx("div",{"data-testid":"file-input",className:k,"aria-disabled":m,children:i.jsxs("div",{"data-testid":"file-input-droptarget",className:G,onDragOver:V,onDragLeave:W,onDrop:J,children:[f.length>0&&i.jsxs("div",{"data-testid":"file-input-preview-heading",className:"usa-file-input__preview-heading",children:[Q," ",i.jsxs("span",{className:"usa-file-input__choose",children:["Change file",f.length>1&&"s"]})]}),i.jsxs("div",{"data-testid":"file-input-instructions",className:z,"aria-hidden":"true",children:[!L&&i.jsx("span",{className:"usa-file-input__drag-text",children:a||B}),i.jsx("span",{className:"usa-file-input__choose",children:r||H})]}),f,i.jsx("div",{"data-testid":"file-input-box",className:"usa-file-input__box"}),y&&i.jsx("div",{"data-testid":"file-input-error",className:"usa-file-input__accepted-files-message",children:S||q}),i.jsx("input",{...w,ref:_,type:"file","data-testid":"file-input-input",name:p,id:g,className:"usa-file-input__input",disabled:m,onChange:K,multiple:h,accept:v})]})})},X=t.forwardRef(b);b.__docgenInfo={description:"",methods:[{name:"clearFiles",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}}],displayName:"FileInputForwardRef"};X.__docgenInfo={description:"",methods:[{name:"clearFiles",docblock:null,modifiers:[],params:[],returns:{type:{name:"void"}}}],displayName:"FileInput"};export{X as F};
